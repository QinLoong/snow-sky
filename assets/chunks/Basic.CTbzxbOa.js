import{ab as D,y as O,l as N,ac as S,p as $,d as A,h as f,k as l,o as v,b as x,w as h,a8 as V,m as w,n as H,Q as J,r as P,e as k,c as z,J as g,a2 as Q,a9 as U,T as j,a7 as q,a5 as L,ad as C,a as I}from"./framework.Ctxgs3d4.js";import{R as F}from"./RenderVnode.BEUHtJ0W.js";import{_ as G}from"./Icon.vue_vue_type_script_setup_true_lang.B0S-wqB-.js";import{_ as b}from"./Button.vue_vue_type_script_setup_true_name_SnowButton_lang.DDI5C6yQ.js";function K(n,t,e){D(n)?O(n,(s,a)=>{a==null||a.removeEventListener(t,e),s==null||s.addEventListener(t,e)}):N(()=>{n.addEventListener(t,e)}),S(()=>{var s;(s=$(n))==null||s.removeEventListener(t,e)})}const W={class:"snow-message__content"},X={key:0,class:"snow-message__close"},Y=A({__name:"Message",props:{message:{},duration:{default:3e3},showClose:{type:Boolean},type:{default:"info"},onDestory:{},id:{},zIndex:{},offset:{default:20},transitionName:{default:"fade-up"}},setup(n,{expose:t}){const e=n,s=f(!1),a=f(),u=f(0),m=l(()=>te(e.id)),c=l(()=>e.offset+m.value),y=l(()=>u.value+c.value),p=l(()=>({top:c.value+"px",zIndex:e.zIndex}));let i;function d(){e.duration!==0&&(i=setTimeout(()=>{s.value=!1},e.duration))}function M(){clearTimeout(i)}N(async()=>{s.value=!0,d()});function T(o){o.code==="Escape"&&(s.value=!1)}K(document,"keydown",T);function R(){e.onDestory()}function Z(){u.value=a.value.getBoundingClientRect().height}return t({bottomOffset:y,visible:s}),(o,_)=>(v(),x(j,{name:o.transitionName,onAfterLeave:R,onEnter:Z},{default:h(()=>[V(w("div",{class:H(["snow-message",{[`snow-message--${o.type}`]:o.type,"is-close":o.showClose}]),role:"alert",ref_key:"messageRef",ref:a,style:J(p.value),onMouseenter:M,onMouseleave:d},[w("div",W,[P(o.$slots,"default",{},()=>[o.message?(v(),x($(F),{key:0,vNode:o.message},null,8,["vNode"])):k("",!0)])]),o.showClose?(v(),z("div",X,[g(G,{onClick:_[0]||(_[0]=Q(ae=>s.value=!1,["stop"])),icon:"xmark"})])):k("",!0)],38),[[U,s.value]])]),_:3},8,["name"]))}}),E=f(0),ee=(n=2e3)=>{const t=f(n),e=l(()=>E.value+t.value);return{currentZIndex:e,nextZIndex:()=>(E.value++,e.value),initialZIndex:t}};let se=1;const r=q([]),B=n=>{const{nextZIndex:t}=ee(),e=`message_${se++}`,s=document.createElement("div"),a=()=>{const i=r.findIndex(d=>d.id===e);i!==-1&&(r.splice(i,1),C(null,s))},u=()=>{const i=r.find(d=>d.id===e);i&&(i.vm.exposed.visible.value=!1)},m={...n,id:e,zIndex:t(),onDestory:a},c=L(Y,m);C(c,s),document.body.appendChild(s.firstElementChild);const y=c.component,p={id:e,vnode:c,vm:y,props:m,destory:u};return r.push(p),p},te=n=>{const t=r.findIndex(e=>e.id===n);return console.log(n,t,r.length),t<=0?0:r[t-1].vm.exposed.bottomOffset.value},le=()=>{r.forEach(n=>{n.destory()})},ne={class:"basic block"},oe={__name:"Basic",setup(n){const t=()=>{B({message:"hello world",type:"success"})},e=()=>{B({message:L("b","this is bold"),type:"danger"})};return(s,a)=>(v(),z("div",ne,[g(b,{type:"primary",onClick:t},{default:h(()=>[I(" 创建一条消息 ")]),_:1}),g(b,{onClick:e},{default:h(()=>[I(" 创建支持 VNode 的消息 ")]),_:1})]))}},fe=oe;export{le as a,B as c,fe as d};
